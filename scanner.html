<html>
    <head>

    </head>
    <body>
        <video id="video" width="100%" height="100%" autoplay></video>
        <h4 id="qrcode_str"></h4>
        <script language="javascript" async>
            const video = document.querySelector("#video");
            //Check if device has camera
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                const constrain = {
                    video : {
                        facingMode : {
                            exact: 'environment'
                        }
                    },
                    audio : false   
                }

                //start video stream
                navigator.mediaDevices.getUserMedia(constrain).then(stream => video.srcObject = stream);

                const container_hasil = document.querySelector('#qrcode_str');

                //Mendklarasi class barcode detector
                const qrcodeDetector = new BarcodeDetector({ formats : ['qr_code'] });

                const deteksiKode = () => {
                    //Mulai mendeteksi qrcode
                    qrcodeDetector.detect(video).then(codes => {
                        
                        if (codes.length === 0) return;
                        
                        for (const qrcode of codes) {
                            container_hasil.innerHTML = "";
                            container_hasil.innerHTML = qrcode.rawValue;
                        }

                    })
                    .catch(err => {
                        container_hasil.innerHTML = "";
                        container_hasil.innerHTML = "Maaf, Kode tidak terbaca";
                    });
                }

                setInterval(deteksiKode, 1000);
            }
        </script>
    </body>
</html>